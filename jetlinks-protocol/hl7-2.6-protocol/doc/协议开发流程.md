# 协议开发流程

开发协议包的目的是将设备的原始报文数据与平台的数据进行解析和封装，以便于平台对设备进行统一的管理和控制。
其中核心是协议解析，协议封装，协议的功能扩展。

## 需求分析

1. 分析协议的数据结构，定义协议的数据结构对象。
2. 分析协议中与平台的内置的[设备消息](%E8%AE%BE%E5%A4%87%E6%B6%88%E6%81%AFAPI.md)。正确使用属性上报，功能调用，和事件上报。

## 开发协议编解码逻辑

1. 将解析的核心逻辑单独封装成一个工具类，注意: 对字节的相关操作直接使用netty的ByteBuf进行处理。
2. 基于[使用阻塞式编写解析逻辑](
   %E4%BD%BF%E7%94%A8%E9%98%BB%E5%A1%9E%E5%BC%8F%E7%BC%96%E5%86%99%E8%A7%A3%E6%9E%90%E9%80%BB%E8%BE%91.
   md)文档编写解析逻辑。
3. 在2步创建的DeviceMessageCodec中调用第1步封装的工具类进行处理。
4. 编写单元测试，验证相关逻辑的正确性。

## 创建协议提供商

基于[协议提供商.md](%E5%8D%8F%E8%AE%AE%E6%8F%90%E4%BE%9B%E5%95%86.md)中的示例，创建一个协议提供商类。

请根据实际情况添加协议的消息编解码器，设备认证器等，在mqtt broker、http、websocket场景下，请定义路由信息，否则将无法接收到设备消息。

